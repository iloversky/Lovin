/**************************************************************

 @Name : layer v1.4.2 弹层组件压缩版
 @author: 贤心
 @date: 2012-12-2
 @blog: http://xu.sentsin.com
 @微博：http://t.qq.com/xian_xin
 @QQ群：176047238(layer交流2群)
 @Copyright: Sentsin Xu(贤心)
 @官网说明：http://xu.sentsin.com/jquery/layer
 @赞助layer: https://me.alipay.com/sentsin
		
 *************************************************************/ 
 	
;void function(f,e,c){
	var a=false, //是否采用自动获取绝对路径。 false：将采用相对路径，需配置d
	d="http://xu.sentsin.com/lily/lib/layer/", //相对路径url
	g={getPath:function(){var k=document.scripts||e("script"),j=k[k.length-1].src;return j.substring(0,j.lastIndexOf("/")+1);},append:function(){a&&(d=this.getPath());var j='<!--[if IE 6]><script type="text/javascript" src="'+d+'skin/png.js"><\/script><![endif]-->';e("head").prepend('\n<link rel="stylesheet" type="text/css" href="'+d+'skin/layer.css"  />');document.write(j);},global:{iE6:!-[1,]&&!f.XMLHttpRequest,times:0,config:{}}},h=e(f);g.append();var b=Function();b.prototype={v:"1.4.2",alert:function(k,l,m,j){return e.layer({dialog:{msg:k,type:l,yes:j},title:m});},confirm:function(k,j,l,m){return e.layer({dialog:{msg:k,type:4,btns:2,yes:j,no:m},title:l});},msg:function(l,k,j,m){(l==""||l==c)&&(l="&nbsp;");(k==c||k=="")&&(k=2);return e.layer({dialog:{msg:l,type:j,maxWidth:m},time:k,title:["",false],closeBtn:["",false]});},tips:function(k,j,m,l){return e.layer({type:4,shade:false,time:m,maxWidth:l,tips:{msg:k,follow:j}});},load:function(k,m,j){var l=true;m==3&&(l=false);return e.layer({time:k,shade:j,loading:{type:m},border:[10,0.3,"#000",l],type:3,title:["",false],closeBtn:[0,false]});}};layer=new b();var i=function(j){this.init(j);};i.prototype={type:function(){return["dialog","page","iframe","loading","tips"];},config:{skin:0,shade:[0.5,"#000",true],shadeClose:false,fix:true,move:[".xubox_title",true],type:0,title:["信息",true],offset:["200px","50%"],area:["310px","auto"],closeBtn:[0,true],time:0,border:[10,0.3,"#000",true],zIndex:19891014,maxWidth:400,fadeIn:[300,false],dialog:{btns:1,btn:["确定","取消"],type:3,msg:"",yes:function(j){LAYER.close(j);},no:function(j){LAYER.close(j);}},page:{dom:"#xulayer"},iframe:{src:"http://xu.sentsin.com"},loading:{type:0},tips:{msg:"",follow:""},success:function(j){},close:function(j){LAYER.close(j);},end:function(){}},init:function(k){g.global.times++;var j=this.config;this.config=e.extend({},j,k);this.dialog=e.extend({},j.dialog,k.dialog);this.page=e.extend({},j.page,k.page);this.iframe=e.extend({},j.iframe,k.iframe);this.loading=e.extend({},j.loading,k.loading);this.tips=e.extend({},j.tips,k.tips);this.adjust();},space:function(){var j=g.global.times,k=g.global.config[j]=this.config;k.dialog=this.dialog;k.page=this.page;k.iframe=this.iframe;k.loading=this.loading;k.tips=this.tips;var m=this.config,p=this.dialog,l=['<div class="xubox_dialog"><span class="xubox_msg xulayer_png32 xubox_msgico xubox_msgtype'+p.type+'"></span><span class="xubox_msg xubox_text">'+p.msg+"</span></div>",'<div class="xubox_page xubox_page_'+m.skin+'"></div>','<iframe id="xubox_iframe" name="xubox_iframe" onload="javascript:$(\'.xubox_layer\').find(\'.xubox_iframe\').removeClass(\'xubox_load\');" class="xubox_iframe" frameborder="0" src="'+this.iframe.src+'"></iframe>','<span class="xubox_loading xubox_loading_'+this.loading.type+'"></span>','<div class="xubox_tips xubox_tips_'+m.skin+'"><div class="xubox_tipsMsg">'+this.tips.msg+'</div><i class="xulayer_png32"></i></div>'];var r="",n="",j=g.global.times;this.zIndex=m.zIndex+j;var q=this.zIndex,s="z-index:"+q+"; background:"+m.shade[1]+"; opacity:"+m.shade[0]+"; filter:'alpha(opacity="+m.shade[0]*100+")'; filter:alpha(opacity="+m.shade[0]*100+");";m.shade[2]&&(r='<div times="'+j+'" id="xubox_shade'+j+'" class="xubox_shade xubox_shade_'+m.skin+'" style="'+s+'"></div>');var t="z-index:"+(q-1)+";  background: "+m.border[2]+"; opacity:"+m.border[1]+"; filter:'alpha(opacity="+m.border[1]*100+")'; filter:alpha(opacity="+m.border[1]*100+"); top:-"+m.border[0]+"px; left:-"+m.border[0]+"px;";m.border[3]&&(n='<div id="xubox_border'+j+'" class="xubox_border" style="'+t+'"></div>');var o='<div times="'+j+'" showtime="'+m.time+'" style="z-index:'+q+'" id="xubox_layer'+j+'" class="xubox_layer xubox_layer_'+m.skin+'"><div style="z-index:'+q+'" class="xubox_main xubox_main_'+m.skin+'">'+l[m.type]+'<h2 class="xubox_title xubox_title_'+m.skin+'"><i class="xulayer_png32"></i><em>'+m.title[0]+'</em></h2><a class="xubox_close xulayer_png32 xubox_close'+m.closeBtn[0]+"_"+m.skin+'" href="javascript:;"></a><span class="xubox_botton"></span></div>'+n+"</div>";return[r,o];},adjust:function(){var l=this,j="",m=this.config,q=this.dialog,p=this.page,o=function(){j=l.space();e("body").append(j[0]);};switch(m.type){case 1:if(e(p.dom).parents(".xubox_page").length==0){o();e(p.dom).show().wrap(j[1]);}else{return false;}break;case 2:e(".xubox_layer").find(".xubox_iframe").length>0&&LAYER.close(e(".xubox_iframe").parents(".xubox_layer").attr("times"));o();e("body").append(j[1]);break;case 3:m.title=["",false];m.area=["auto","auto"];m.closeBtn=["",false];e(".xubox_layer").find(".xubox_loading").length>0&&LAYER.close(e(".xubox_loading").parents(".xubox_layer").attr("times"));o();e("body").append(j[1]);break;case 4:m.title=["",false];m.area=["auto","auto"];m.fix=false;m.border=[0,0,0,false];e(".xubox_layer").find(".xubox_tips").length>0&&LAYER.close(e(".xubox_tips").parents(".xubox_layer").attr("times"));o();e("body").append(j[1]);e(".xubox_tips").fadeIn(200).parents(".xubox_layer").find(".xubox_close").css({top:5,right:5});break;default:m.title[1]||(m.area=["auto","auto"]);e(".xubox_layer").find(".xubox_dialog").length>0&&LAYER.close(e(".xubox_dialog").parents(".xubox_layer").attr("times"));o();e("body").append(j[1]);break;}var k=g.global.times;this.layerS=e("#xubox_shade"+k);this.layerB=e("#xubox_border"+k);this.layerE=e("#xubox_layer"+k);var n=this.layerE;if(m.offset[1].indexOf("px")!=-1){var r=parseInt(m.offset[1]);}else{if(m.offset[1]=="50%"){var r=m.offset[1];}else{var r=parseInt(m.offset[1])/100*h.width();}}n.css({left:r+m.border[0],width:m.area[0],height:m.area[1]});m.fix?n.css({top:parseInt(m.offset[0])+m.border[0]}):n.css({top:parseInt(m.offset[0])+h.scrollTop()+m.border[0],position:"absolute"});this.layerMian=n.find(".xubox_main");this.layerTitle=n.find(".xubox_title");this.layerText=n.find(".xubox_text");this.layerPage=n.find(".xubox_page");this.layerBtn=n.find(".xubox_botton");if(m.type==0&&m.title[1]){switch(q.btns){case 0:this.layerBtn.html("").hide();break;case 2:this.layerBtn.html('<a href="javascript:;" class="xubox_yes xubox_botton2_'+m.skin+'">'+q.btn[0]+'</a><a href="javascript:;" class="xubox_no xubox_botton3_'+m.skin+'">'+q.btn[1]+"</a>");break;default:this.layerBtn.html('<a href="javascript:;" class="xubox_yes xubox_botton1_'+m.skin+'">'+q.btn[0]+'</a><a class="xubox_no" style="displa:none;"></a>');}}this.pagetype(k);this.callback(m);},pagetype:function(j){var k=this,n=this.layerE,l=this.config,q=this.page;k.autoArea(j);l.time==0||this.autoclose();l.move[1]?n.find(".xubox_title").css({cursor:"move"}):n.find(".xubox_title").css({cursor:"auto"});l.closeBtn[1]||n.find(".xubox_close").remove().hide();if(!l.title[1]){n.find(".xubox_title").remove().hide();l.type!=4&&n.find(".xubox_close").removeClass("xubox_close0_"+l.skin).addClass("xubox_close1_"+l.skin);}else{this.layerTitle.css({width:n.outerWidth()});}l.border||n.removeClass("xubox_layerBoder");var o=parseInt(this.layerMian.css("margin-right")),p=parseInt(n.css("padding-bottom"));n.attr({type:k.type()[l.type]});switch(l.type){case 1:n.find(q.dom).addClass("layer_pageContent");this.layerPage.css({width:n.width()-2*o});l.shade&&n.css({"z-index":k.zIndex+1});l.title[1]?this.layerPage.css({top:o+this.layerTitle.outerHeight()}):this.layerPage.css({top:o});break;case 2:n.find(".xubox_iframe").addClass("xubox_load").css({width:n.width()-2*o});l.title[1]?n.find(".xubox_iframe").css({top:this.layerTitle.height()+p,height:n.height()-this.layerTitle.height()}):n.find(".xubox_iframe").css({top:p,height:n.height()});g.global.iE6&&n.find("#xubox_iframe").attr("src",k.iframe.src);break;case 4:var r=e(k.tips.follow).offset().top-e(k.tips.follow).outerHeight()-n.outerHeight()+15;var m=e(k.tips.follow).offset().left+n.outerWidth()/2;n.css({top:r,left:m});break;default:if(l.title[1]){this.layerText.css({paddingTop:18+this.layerTitle.outerHeight()});}else{n.find(".xubox_msgico").css({top:"10px"});this.layerText.css({marginTop:12});}break;}var s=0;l.fadeIn[1]&&(s=l.fadeIn[0]);n.animate({opacity:1,filter:"alpha(opacity="+100+")"},s);this.move();},autoArea:function(k){var m=this,r=e("#xubox_layer"+k),n=g.global.config[k],t=n.page,o=r.find(".xubox_main"),l=r.find(".xubox_botton"),p=r.find(".xubox_text"),j=r.find(".xubox_page"),s=e("#xubox_border"+k);if(n.area[0]=="auto"&&o.outerWidth()>=n.maxWidth){r.css({width:n.maxWidth});}n.title[1]?titHeight=r.find(".xubox_title").innerHeight():titHeight=0;switch(n.type){case 0:var u=l.find("a"),v=p.outerHeight()+20;if(u.length>0){var q=l.find("a").outerHeight()+parseInt(l.find("a").css("bottom"))+10;}else{var q=0;}break;case 1:var q=0,v=e(t.dom).outerHeight();n.area[0]=="auto"&&r.css({width:j.outerWidth()});break;case 3:var q=0;var v=e(".xubox_loading").outerHeight();o.css({width:e(".xubox_loading").width()});break;}(n.offset[1]=="50%"||n.offset[1]=="")?r.css({marginLeft:-r.outerWidth()/2}):r.css({marginLeft:0});n.area[1]=="auto"&&o.css({height:titHeight+v+q});s.css({width:r.outerWidth()+2*n.border[0],height:r.outerHeight()+2*n.border[0]});(g.global.iE6&&n.area[0]!="auto")&&o.css({width:r.outerWidth()});},move:function(){var k=this.config,j=this.layerE.find(k.move[0]);k.move[1]&&j.attr("move","ok");e(k.move[0]).mousedown(function(p){p.preventDefault();var o=e(this).parents(".xubox_layer");if(e(this).attr("move")==="ok"){var m=true,n=p.pageX-parseInt(o.position().left),l=p.pageY-parseInt(o.position().top);e(document).mousemove(function(s){if(m){var q=s.pageX-n;if(o.css("position")=="fixed"){var r=s.pageY-l-h.scrollTop();}else{var r=s.pageY-l;}o.css({left:q,top:r});}}).mouseup(function(){m=false;});}});},autoclose:function(){e.each(g.global.config,function(k,m){var n=m.time;var j=function(){n--;n===0&&LAYER.close(k);e(".xubox_layer").length<1&&clearInterval(l);};var l=setInterval(j,1000);});},callback:function(m){LAYER=new this.openLayer(this);var l=this.layerE,j=this.config,k=this.dialog;this.config.success(l);g.global.iE6&&this.IE6();e(".xubox_close").off("click").on("click",function(){var n=e(this).parents(".xubox_layer").attr("times");try{g.global.config[n].close(n);}catch(o){LAYER.close(n);}});l.find(".xubox_yes").off("click").on("click",function(){var n=e(this).parents(".xubox_layer").attr("times");k.yes(n);});l.find(".xubox_no").off("click").on("click",function(){var n=e(this).parents(".xubox_layer").attr("times");k.no(n);});this.layerS.off("click").on("click",function(){var n=e(this).attr("times");g.global.config[n].shadeClose&&LAYER.close(n);});},IE6:function(){var n=this,o=this.layerE,k=e("select"),j=function(){var p=[e(document).width(),e(document).height(),h.width()];p[0]>p[1]&&(p[0]=p-17);n.layerS.css({width:p[0],height:p[1]});};j();h.resize(j).scroll(j);var m=o.offset().top;if(this.config.fix){var l=function(){o.css({top:e(document).scrollTop()+m});};}else{var l=function(){o.css({top:m});};}l();h.scroll(l);e.each(k,function(p,q){var r=e(this);if(!r.parents(".xubox_layer")[0]){r.css("display")=="none"||r.attr({layer:"1"}).hide();}});this.reselect=function(){e.each(k,function(p,q){var r=e(this);if(!r.parents(".xubox_layer")[0]){(r.attr("layer")==1&&e(".xubox_layer").length<1)&&r.removeAttr("layer").show();}});};DD_belatedPNG.fix(".xulayer_png32");},openLayer:function(j){this.autoArea=function(k){if(typeof k!="number"){return j.autoArea(g.global.times);}else{return j.autoArea(k);}};this.getIndex=function(k){return e(k).parents(".xubox_layer").attr("times");};this.getChildFrame=function(k){return e("#xubox_iframe").contents().find(k);};this.getFrameIndex=function(){return e("#xubox_iframe").parents(".xubox_layer").attr("times");};this.close=function(l){var n=e("#xubox_layer"+l),k=e("#xubox_shade"+l);if(n.attr("type")==j.type()[1]){n.find(".xubox_close,.xubox_botton,.xubox_title,.xubox_border").remove();for(var m=0;m<3;m++){n.find(".layer_pageContent").unwrap().hide();}}else{e.browser.msie&&n.find("#xubox_iframe").remove();n.remove();}k.remove();try{g.global.iE6&&j.reselect();g.global.config[l].end();g.global.times--;delete g.global.config[l];}catch(o){}};this.loadClose=function(){var l=e(".xubox_loading").parents(".xubox_layer"),k=l.attr("times");e("#xubox_shade"+k).remove();l.remove();};this.shift=function(p,o){var m=j.config,n=g.global.iE6,r=j.layerE,l=0,q=h.width(),k=h.height();(m.offset[1]=="50%"||m.offset[1]=="")?l=r.outerWidth()/2:l=r.outerWidth();switch(p){case"left-top":r.css({left:l+m.border[0],top:-r.outerHeight()}).animate({top:m.border[0]},o,function(){n&&j.IE6();});break;case"right-top":r.css({left:q-l-m.border[0],top:-r.outerHeight()}).animate({top:m.border[0]},o,function(){n&&j.IE6();});break;case"left-bottom":r.css({left:l+m.border[0],top:k}).animate({top:k-r.outerHeight()-m.border[0]},o,function(){n&&j.IE6();});break;case"right-bottom":r.css({left:q-l-m.border[0],top:k}).animate({top:k-r.outerHeight()-m.border[0]},o,function(){n&&j.IE6();});break;}};}};e.layer=function(j){return new i(j);};}(window,jQuery);